<apex:page controller="ob1.OutputManagerController" sidebar="false" showheader="false">

<apex:outputText style="font-size:16pt;" rendered="{!NOT(ISNULL(Description))}" value="{!Description}"/>

<apex:form >

<apex:pageBlock rendered="{!display='PREVIEW'}">
 <apex:pageBlockTable value="{!OutputHistory}" var="oh">
     <apex:column headerValue="View" >
       <apex:outputLink value="/apex/Output?output_id={!oh.Id}" target="_blank">View</apex:outputLink>
     </apex:column>
     <apex:column headerValue="Action" rendered="{!NOT(SaveOnly)}">
       <apex:commandLink rendered="{!(NOT(Requires_Approval) || oh.ob1__Approved__c) && oh.ob1__Status__c = 'sent'}" action="{!selectOutput}">Resend
          <apex:param name="ID"      value="{!oh.Id}" assignTo="{!OutputID}"/>
          <apex:param name="display" value="RS"       assignTo="{!display}"/>
        </apex:commandLink>
       <apex:commandLink rendered="{!(NOT(Requires_Approval) || oh.ob1__Approved__c) && oh.ob1__Status__c = 'saved'}" action="{!send}">Send
          <apex:param name="ID"      value="{!oh.Id}" assignTo="{!OutputID}"/>
        </apex:commandLink>
     </apex:column>
     

     <apex:column headerValue="Generated On" value="{!oh.CreatedDate}"/>
     <apex:column headerValue="Generated By" value="{!oh.CreatedBy.Name}"/>
 </apex:pageBlockTable> 
 <apex:commandLink action="{!reload}">{!IF(moreShow,"Show Last 5","Show All")}
 <apex:param name="moreShow" value="{!NOT(moreShow)}" assignTo="{!moreShow}"/>
 </apex:commandLink>
</apex:pageBlock>

<apex:pageBlock rendered="{!display='CONFIRM'}">
<apex:outputPanel >
    <apex:outputText >Your message has been sent!</apex:outputText><br/>
    <apex:commandButton action="{!confirm}" value="ok"/>
</apex:outputPanel>
</apex:pageBlock>

<apex:pageBlock rendered="{!display='RS'}">
<apex:outputPanel >
   <apex:pageBlockTable value="{!rsAddresses}" var="rs">
      <apex:column headerValue="Resend To:" value="{!rs}"/>
      <apex:column >
        <apex:commandLink action="{!removeToAddress}">remove
          <apex:param name="value" value="{!rs}" assignTo="{!Remove}"/>
        </apex:commandLink>
      </apex:column>
   </apex:pageBlockTable> 
   <br/>
   <br/>
   <table>
   <tr>
   <td>Enter Address(es)</td>
   <td><apex:inputField style="width:512px;" value="{!addContact.ob1__Free_Form__c}" />&nbsp;&nbsp;</td>
   <td rowspan="2" style="vertical-align:middle;"><apex:commandButton action="{!addRSAddress}" value="Add Address(es)"/></td>
   </tr>
   <tr>
   <td>Contact Lookup</td> 
   <td><apex:inputField value="{!addContact.ob1__Contact__c}" /></td>
   </tr>
   </table> 
   <br/>
   <br/>
   <apex:commandButton action="{!resend}" value="Resend" rendered="{!(NOT(Requires_Approval) || IsApproved) && Status = 'sent'}" disabled="{!PreviewRS=''}"/> &nbsp;&nbsp;
   <apex:commandLink action="{!reload}">Cancel
     <apex:param name="pclose" value="PREVIEW" assignTo="{!display}"/>
   </apex:commandLink>
</apex:outputPanel>
<br/>
<br/>
Previously Sent To:
<br/>
<table style="width:100%;">
<tr>
<td><b>To:</b></td>
<td style="width:100%;"><apex:outputText value="{!PreviewTo}" /></td>
</tr>
<tr>
<td><b>CC:</b></td>
<td style="width:100%;"><apex:outputText value="{!PreviewCC}" /></td>
</tr>
<tr>
<td><b>BCC:</b></td>
<td style="width:100%;"><apex:outputText value="{!PreviewBCC}" /></td>
</tr>
</table>


</apex:pageBlock>

</apex:form>



</apex:page>